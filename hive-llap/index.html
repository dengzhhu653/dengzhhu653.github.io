<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Zhihua Deng"><meta name="description" content="Hivellap&amp;#x5C1D;&amp;#x8BD5;&amp;#x5728;Hive2.0&amp;#x7248;&amp;#x672C;&amp;#x4E0A;&amp;#x5F15;&amp;#x8FDB;&amp;#x4E86;Hivellap(LiveLongandProcess)&amp;#x8FD9;&amp;#x79CD;&amp;#x"><meta name="keywords" content="大数据,Hadoop,Hive,Llap"><title>Hive Llap尝试（0） · null</title><link rel="icon" href="../favicon.ico"><link rel="canonical" href="https://dengzhhu653.github.io/hive-llap/"><link rel="alternate" href="../atom.xml" title="null"><link rel="stylesheet" href="../fonts/iconfont/iconfont.css"><link rel="stylesheet" href="../css/style.css"><script type="text/javascript">var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?Your baidu Analytics ID";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'Your Google Analytics ID', 'auto');
ga('send', 'pageview');</script></head><body><div id="main"><header><a href="../." class="logo"></a><ul class="nav"><li class="nav-link"><a href="/archives/" target="_self">Archives</a></li><li class="nav-link"><a href="/about/" target="_self">About</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">Hive Llap尝试（0）</h1><span class="post-time">Mar 15, 2017</span><div id="sidebar" class="post-sidebar"><h3 class="heading">Contents</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive-llap尝试"><span class="toc-text">Hive llap尝试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#部署安装"><span class="toc-text">部署安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置"><span class="toc-text">配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题解决"><span class="toc-text">问题解决</span></a></li></ol></div><div class="post-content"><h2 id="Hive-llap&#x5C1D;&#x8BD5;"><a href="#Hive-llap&#x5C1D;&#x8BD5;" class="headerlink" title="Hive llap&#x5C1D;&#x8BD5;"></a>Hive llap&#x5C1D;&#x8BD5;</h2><p> &#x5728;Hive2.0&#x7248;&#x672C;&#x4E0A;&#x5F15;&#x8FDB;&#x4E86;<code>Hive llap(Live Long and Process)</code>&#x8FD9;&#x79CD;&#x65B0;&#x7279;&#x6027;&#xFF0C;&#x4E0E;Tez&#x8BA1;&#x7B97;&#x5F15;&#x64CE;&#x7ED3;&#x5408;&#x7D27;&#x5BC6;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;Presto&#x548C;Impala&#xFF0C; &#x5979;&#x9884;&#x5148;&#x542F;&#x52A8;&#x4E00;&#x7EC4;&#x8FDB;&#x7A0B;&#xFF0C;&#x7B49;&#x5F85;&#x6709;&#x89E3;&#x6790;&#x597D;&#x7684;task&#x7684;&#x5230;&#x6765;&#x5E76;&#x6267;&#x884C;&#x3002; &#x5728;&#x8FD9;&#x8BA1;&#x7B97;&#x6A21;&#x578B;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#xFF0C;&#x5979;&#x8FD8;&#x5F15;&#x5165;&#x4E00;&#x4E9B;&#x52A0;&#x5FEB;task&#x8BA1;&#x7B97;&#x7684;&#x7279;&#x6027;&#xFF1A;<br> <ol><br>   <li>&#x5F02;&#x6B65;&#x6570;&#x636E;&#x611F;&#x77E5;IO</li><br>   <li>&#x8BA1;&#x7B97;&#x6570;&#x636E;&#x9884;&#x8BFB;&#x53D6;&#x548C;&#x5217;&#x7F13;&#x5B58;</li><br>   <li>&#x826F;&#x597D;&#x5730;&#x5E76;&#x884C;&#x5316;&#x6267;&#x884C;task</li><br> </ol><br>&#x5F97;&#x76CA;&#x4E8E;&#x8FC7;&#x53BB;&#x4E24;&#x5E74;&#x91CC;&#x793E;&#x533A;&#x63D0;&#x4EA4;&#x7684;&#x5404;&#x79CD;&#x7279;&#x6027;&#x548C;&#x6539;&#x8FDB;&#xFF0C;Hive&#x80FD;&#x591F;&#x663E;&#x8457;&#x7684;&#x53D8;&#x5FEB;.<br><br> <ul><br>   <li><a href="https://cwiki.apache.org/confluence/display/Hive/LLAP" target="_blank" rel="external">https://cwiki.apache.org/confluence/display/Hive/LLAP</a></li><br>   <li><a href="http://www.slideshare.net/Hadoop_Summit/llap-longlived-execution-in-hive" target="_blank" rel="external">http://www.slideshare.net/Hadoop_Summit/llap-longlived-execution-in-hive</a></li><br> </ul></p>
<h2 id="&#x90E8;&#x7F72;&#x5B89;&#x88C5;"><a href="#&#x90E8;&#x7F72;&#x5B89;&#x88C5;" class="headerlink" title="&#x90E8;&#x7F72;&#x5B89;&#x88C5;"></a>&#x90E8;&#x7F72;&#x5B89;&#x88C5;</h2> <table><tr><th> &#x8F6F;&#x4EF6; </th><th> &#x7248;&#x672C; </th><th> &#x5B89;&#x88C5;&#x8BF4;&#x660E; </th></tr><tr><td>tez</td><td>0.8.4</td><td><a href="https://tez.apache.org/install.html" target="_blank" rel="external">tez&#x5B89;&#x88C5;</a>&#xFF0C;&#x4FEE;&#x6539;&#x4F9D;&#x8D56;&#x7684;hadoop&#x7248;&#x672C;&#x548C;guava&#x7248;&#x672C;&#xFF0C;&#x91CD;&#x65B0;&#x7F16;&#x8BD1;&#xFF0C;&#x5728;tez-dist&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x627E;&#x5230;tez-0.8.4-minimal.tar.gz&#x6587;&#x4EF6;&#x3002;</td></tr><tr><td>hadoop&#xFF0C;&#x5305;&#x62EC;yarn&#xFF0C;hdfs</td><td>&#x57FA;&#x4E8E;2.7.1</td><td>&#x7565;</td></tr><tr><td>zookeeper</td><td>3.4.6</td><td><a href="https://zookeeper.apache.org/doc/r3.4.8/zookeeperStarted.html#sc_RunningReplicatedZooKeeper" target="_blank" rel="external">zookeeper&#x5B89;&#x88C5;</a></td></tr><tr><td>slider</td><td>slider-0.81.1-incubating</td><td><a href="https://slider.incubator.apache.org/docs/getting_started.html#install" target="_blank" rel="external">slider&#x5B89;&#x88C5;&#x914D;&#x7F6E;</a>&#xFF0C;&#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x540E;&#x5C06;bin&#x76EE;&#x5F55;&#x52A0;&#x5165;&#x5230;$PATH&#x53D8;&#x91CF;&#x4E2D;</td></tr><tr><td>hive</td><td>apache-hive-2.1.1</td><td>&#x4ECE;apache&#x5B98;&#x7F51;&#x540E;&#x4E0B;&#x8F7D;&#x53EF;&#x6267;&#x884C;&#x7684;&#x5305;&#xFF0C;&#x89E3;&#x538B;&#x5230;&#x76F8;&#x5173;&#x7684;&#x76EE;&#x5F55;&#x4E2D;</td></tr></table>

<h2 id="&#x914D;&#x7F6E;"><a href="#&#x914D;&#x7F6E;" class="headerlink" title="&#x914D;&#x7F6E;"></a>&#x914D;&#x7F6E;</h2><table><tr><th>&#x5C5E;&#x6027;</th><th>&#x4F4D;&#x7F6E;</th> <th>&#x8BF4;&#x660E;</th></tr><tr><td>hive.execution.engine</td><td>hive-site.xml</td><td>&#x76EE;&#x524D;llap&#x4EC5;&#x652F;&#x6301;tez&#xFF0C;&#x8BE5;&#x5C5E;&#x6027;&#x503C;&#x987B;&#x4E3A;tez</td></tr><tr><td>hive.llap.execution.mode</td><td>hive-site.xml</td><td>value&#x53EF;&#x4EE5;&#x4E3A;all, auto, map, none. &#x6211;&#x4EEC;&#x914D;&#x7F6E;&#x6210;all<br>&#x8BA9;&#x6240;&#x6709;&#x7684;task&#x90FD;&#x5728;llap&#x8FDB;&#x7A0B;&#x5185;&#x6267;&#x884C;&#x3002;</td></tr><tr><td>hive.execution.mode</td><td>hive-site.xml</td><td>value&#x4E3A;llap</td></tr><tr><td>hive.llap.daemon.service.hosts</td><td>hive-site.xml</td><td>&#x670D;&#x52A1;&#x7684;&#x540D;&#x79F0;&#xFF0C;&#x5982;&#x901A;&#x8FC7;&#x201D;hive &#x2013;service llap &#x2013;name llap_service&#x201D;&#x751F;&#x6210;&#x542F;&#x52A8;&#x811A;&#x672C;&#x65F6;,&#x5C06;&#x8BE5;&#x5C5E;&#x6027;&#x914D;&#x7F6E;&#x6210;@llap_service</td></tr><tr><td>hive.llap.daemon.work.dirs</td><td>hive-site.xml</td><td>&#x7F3A;&#x5C11;&#x8BE5;&#x914D;&#x7F6E;&#x65E0;&#x6CD5;&#x542F;&#x52A8;llap daemon, &#x53EF;&#x80FD;&#x662F;&#x542F;&#x52A8;&#x7528;&#x6237;&#x6CA1;&#x6709;yarn.nodemanager.local-dirs&#x914D;&#x7F6E;&#x4E0A;&#x76EE;&#x5F55;&#x7684;&#x8BFB;&#x5199;&#x6743;&#x9650;&#x3002;</td></tr><tr><td>hive.zookeeper.quorum</td><td>hive-site.xml</td><td>&#x7F3A;&#x5C11;&#x8BE5;&#x914D;&#x7F6E;&#x65E0;&#x6CD5;&#x542F;&#x52A8;llap daemon&#xFF0C;zk&#x8282;&#x70B9;&#x7528;&#x9017;&#x53F7;&#x5206;&#x9694;</td></tr><tr><td>hive.zookeeper.client.port</td><td>hive-site.xml</td><td>2181</td></tr><tr><td>hive.llap.daemon.memory.per.instance.mb</td><td>hive-site.xml</td><td>&#x8FD9;&#x4E2A;&#x5F88;&#x5947;&#x602A;&#xFF0C;&#x5373;&#x4F7F;&#x5728;&#x542F;&#x52A8;&#x547D;&#x4EE4;&#x4E2D;&#x6307;&#x5B9A;daemon&#x5185;&#x5B58;&#x548C;executor&#x7684;&#x6570;&#x91CF;&#xFF0C;&#x542F;&#x52A8;llap&#x670D;&#x52A1;&#x65F6;&#x4E5F;&#x4F1A;&#x5931;&#x8D25;&#xFF0C;&#x5FC5;&#x987B;&#x914D;&#x7F6E;&#x5728;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;</td></tr><tr><td>hive.llap.daemon.num.executors</td><td>hive-site.xml</td><td>&#x540C;&#x4E0A;</td></tr><tr><td>tez.tez-ui.history-url.base</td><td>tez-site.xml</td><td>tez ui&#x8DEF;&#x5F84;</td></tr><tr><td>tez.lib.uris</td><td>tez-site.xml</td><td>hdfs&#x4E0A;tez-0.8.4-minimal.tar.gz&#x7684;&#x8DEF;&#x5F84;</td></tr> <tr><td>tez.use.cluster.hadoop-libs</td><td>tez-site.xml</td><td>&#x4F7F;&#x7528;&#x7684;&#x662F;tez-0.8.4-minimal.tar.gz&#xFF0C;&#x987B;&#x5C06;&#x8BE5;&#x914D;&#x7F6E;&#x8BBE;&#x7F6E;&#x6210;true</td></tr><tr><td>hive.server2.enable.doAs</td><td>hive-site.xml</td><td>&#x8FD9;&#x91CC;&#x8BBE;&#x7F6E;&#x6210;false</td></tr><tr><td>hadoop.bin.path</td><td>hive-site.xml</td><td>&#x96C6;&#x7FA4;&#x4E0A;hadoop&#x7684;bin&#x8DEF;&#x5F84;</td></tr></table>


<p>&#x914D;&#x7F6E;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x6267;&#x884C;&#x547D;&#x4EE4;&#xFF1A;</p>
<blockquote>
<p>hive &#x2013;service llap &#x2013;name llap_service &#x2013;instances 16 &#x2013;size 7g &#x2013;loglevel INFO &#x2013;args &#x201C; -XX:MaxMetaspaceSize=128m -verbose:class -XX:+UseParNewGC -Xmn1g -XX:+UseConcMarkSweepGC -XX:-UseBiasedLocking -XX:+PerfDisableSharedMem&#x201D; &#x2013;cache 5g &#x2013;executors 30 &#x2013;iothreads 10 &#x2013;slider-am-container-mb 1024</p>
</blockquote>
<p>&#x5F53;&#x770B;&#x5230;&#x65E5;&#x5FD7;&#x8F93;&#x51FA;&#x884C;&#x91CC;&#x6709;&#xFF1A;</p>
<pre>
  Prepared llap-slider-ddMMyyyy/run.sh for running LLAP on Slider
</pre>
&#x540E;&#x610F;&#x5473;&#x7740;&#x73AF;&#x5883;&#x5E94;&#x8BE5;&#x6CA1;&#x4EC0;&#x4E48;&#x95EE;&#x9898;&#x4E86;&#xFF0C; &#x5728;&#x5F53;&#x524D;&#x7684;&#x76EE;&#x5F55;&#x4E0B;&#xFF0C; &#x53EF;&#x4EE5;&#x627E;&#x5230;llap-slider-ddMMyyyy&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#xFF0C;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x6709;&#x56DB;&#x4E2A;&#x6587;&#x4EF6;&#xFF1A;<br>
 <em>appConfig.json  llap-09Mar2017.zip  resources.json  run.sh</em><br>&#x6253;&#x5F00;run.sh&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C; &#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x542F;&#x52A8;&#x548C;&#x505C;&#x6B62;llap&#x670D;&#x52A1;&#x7684;&#x547D;&#x4EE4;&#xFF1A;
 <pre>
slider stop llap_service
slider destroy llap_service --force || slider destroy llap_service
slider install-package --name LLAP --package  $BASEDIR/llap-09Mar2017.zip --replacepkg
slider create llap_service --resources $BASEDIR/resources.json --template $BASEDIR/appConfig.json
 </pre>

<p>&#x6267;&#x884C;run.sh&#x811A;&#x672C;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5728;yarn web&#x7BA1;&#x7406;&#x754C;&#x9762;&#x4E2D;&#xFF0C;&#x770B;&#x5230;Application Type&#x4E3A;org-apache-slider&#xFF0C; Name&#x4E3A;llap_service&#x7684;&#x4E00;&#x4E2A;&#x4F5C;&#x4E1A;&#x4E86;&#x3002;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x4F5C;&#x4E1A;&#x80FD;&#x6301;&#x7EED;4&#xFF5E;6&#x5206;&#x949F;&#x8FD0;&#x884C;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x542F;&#x52A8;hive cli&#xFF0C; &#x6267;&#x884C;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#x7684;sql&#x6765;&#x63A2;&#x7D22;llap&#x4E86;(mode&#x4E00;&#x680F;&#x663E;&#x793A;&#x4E3A;llap)&#x3002; </p>
<pre><code>Status: Running (Executing on YARN cluster with App id application_xxxx)
----------------------------------------------------------------------------------------------
    VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
----------------------------------------------------------------------------------------------
Map 1 ..........      llap     SUCCEEDED     24         24        0        0       0       0
Reducer 2 ......      llap     SUCCEEDED      1          1        0        0       0       0
----------------------------------------------------------------------------------------------
VERTICES: 02/02  [==========================&gt;&gt;] 100%  ELAPSED TIME: 15.01 s
----------------------------------------------------------------------------------------------
</code></pre><p>&#x5982;&#x679C;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x8981;&#x4ED4;&#x7EC6;&#x89C2;&#x5BDF;application&#x4F5C;&#x4E1A;&#x7684;&#x65E5;&#x5FD7;&#x4E86;&#xFF0C; &#x4ECE;&#x4E2D;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x5F53;&#x524D;&#x96C6;&#x7FA4;&#x4E2D;&#x8FD8;&#x6709;&#x54EA;&#x4E9B;&#x6761;&#x4EF6;&#x8FD8;&#x6CA1;&#x88AB;&#x6EE1;&#x8DB3;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x8C03;&#x6574;yarn nodemanager&#x4E2D;&#x7684;&#x53C2;&#x6570;&#xFF1A;</p>
<pre><code>&lt;property&gt;
    &lt;name&gt;yarn.nodemanager.delete.debug-delay-sec&lt;/name&gt;
    &lt;value&gt;3600&lt;/value&gt;
&lt;/property&gt;
</code></pre><p>&#x8FDB;&#x5165;daemon&#x542F;&#x52A8;&#x5931;&#x8D25;&#x7684;nodemanager&#x8282;&#x70B9;&#x4E2D;&#xFF0C;&#x901A;&#x8FC7;&#x672C;&#x5730;&#x542F;&#x52A8;&#x547D;&#x4EE4;&#x548C;&#x65E5;&#x5FD7;&#x8F93;&#x51FA;&#xFF0C;&#x67E5;&#x770B;&#x5931;&#x8D25;&#x7684;&#x539F;&#x56E0;&#x3002;</p>
<h2 id="&#x95EE;&#x9898;&#x89E3;&#x51B3;"><a href="#&#x95EE;&#x9898;&#x89E3;&#x51B3;" class="headerlink" title="&#x95EE;&#x9898;&#x89E3;&#x51B3;"></a>&#x95EE;&#x9898;&#x89E3;&#x51B3;</h2><pre><code>1, llap daemon&#x8FDB;&#x7A0B;&#x4E0D;&#x7A33;&#x5B9A;&#xFF0C;&#x670D;&#x52A1;&#x542F;&#x52A8;&#x5931;&#x8D25;&#x3002;
</code></pre><p>&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x4ECE;&#x76EE;&#x524D;&#x603B;&#x7ED3;&#x6765;&#x770B;&#xFF0C;&#x4E3B;&#x8981;&#x5206;&#x4E3A;3&#x7C7B;&#xFF1A;</p>
<ul><br> <li>hive-site.xml&#x4E0A;&#x7F3A;&#x5C11;&#x4E00;&#x4E9B;&#x914D;&#x7F6E;</li><br> <li>hadoop&#x96C6;&#x7FA4;&#x548C;hive&#x4E4B;&#x95F4;&#x7684;&#x7C7B;&#x51B2;&#x7A81;</li><br> <li>&#x627E;&#x4E0D;&#x5230;&#x76F8;&#x5E94;&#x7684;hadoop&#x7C7B;</li><br></ul> 

<pre><code>1.1 &#x7F3A;&#x5C11;&#x914D;&#x7F6E;
</code></pre><p>&#x8FD9;&#x4E2A;&#x53EF;&#x4EE5;&#x7ED3;&#x5408;&#x65E5;&#x5FD7;&#x548C;&#x4EE3;&#x7801;&#xFF0C;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x7F3A;&#x5C11;&#x4EC0;&#x4E48;&#x914D;&#x7F6E;&#xFF0C;&#x5728;hive-site.xml&#x6587;&#x4EF6;&#x52A0;&#x5165;&#x76F8;&#x5173;&#x7684;&#x914D;&#x7F6E;&#x9879;&#x5373;&#x53EF;&#x3002;</p>
<pre><code>1.2 hadoop&#xFF0C; hive&#x4E4B;&#x95F4;&#x7C7B;&#x51B2;&#x7A81;
</code></pre><p>&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x7ED9;&#x4E88;hadoop&#x4E0A;&#x505A;&#x4E86;&#x4E00;&#x4E9B;&#x6539;&#x8FDB;&#xFF0C;&#x5BFC;&#x81F4;&#x6709;&#x4E00;&#x4E9B;&#x627E;&#x4E0D;&#x5230;&#x7C7B;&#x65B9;&#x6CD5;&#x4EE5;&#x53CA;&#x7C7B;&#x5B9A;&#x4E49;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x662F;&#xFF0C;&#x6309;&#x7167;&#x6307;&#x5B9A;&#x7684;&#x7248;&#x672C;&#x91CD;&#x65B0;&#x7F16;&#x8BD1;tez&#xFF0C;&#x7F16;&#x8BD1;&#x6CA1;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#xFF0C;&#x9009;&#x62E9;minimal&#x538B;&#x7F29;&#x5305;&#x4F5C;&#x4E3A;tez&#x7684;&#x5B89;&#x88C5;&#x8DEF;&#x5F84;&#x5E76;&#x4E0A;&#x4F20;&#x5230;hdfs&#x4E0A;&#x3002;</p>
<pre><code>1.3 &#x627E;&#x4E0D;&#x5230;&#x76F8;&#x5E94;&#x7684;hadoop&#x7C7B;
</code></pre><p>&#x5728;Hadoop&#x73AF;&#x5883;&#x4E2D;&#x627E;&#x4E0D;&#x5230;hadoop&#x7C7B;&#xFF0C;&#x8FD9;&#x786E;&#x5B9E;&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x8BE1;&#x5F02;&#x7684;&#x95EE;&#x9898;&#x3002;&#x901A;&#x8FC7;&#x8C03;&#x7814;&#x53D1;&#x73B0;&#xFF0C;llap&#x8FDB;&#x7A0B;&#x7684;&#x542F;&#x52A8;&#x662F;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;runLlapDaemon.sh&#x811A;&#x672C;&#x547D;&#x4EE4;&#x542F;&#x52A8;&#x7684;&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;&#x811A;&#x672C;&#x662F;&#x5728;<code>llap-slider-ddMMyyyy/llap-ddMMyyyy.zip</code> &#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x5728;&#x89E3;&#x538B;&#x540E;&#x7684;package/files&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x4E00;&#x4E2A;llap-ddMMyyyy.tar.gz&#x538B;&#x7F29;&#x5305;&#xFF0C;&#x89E3;&#x538B;&#x8FD9;&#x4E2A;tar.gz&#x7684;&#x538B;&#x7F29;&#x5305;&#xFF0C;&#x53D1;&#x73B0;&#x5728;&#x540C;&#x7EA7;&#x7684;&#x76EE;&#x5F55;&#x4E0B;&#x51FA;&#x73B0;bin&#x76EE;&#x5F55;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;<code>runLlapDaemon.sh</code>&#x811A;&#x672C;&#x7684;&#x4F4D;&#x7F6E;&#x3002;<br>&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x542F;&#x52A8;&#x811A;&#x672C;&#x4E2D;&#x5BF9;&#x4E8E;CLASSPATH&#x7684;&#x5B9A;&#x4E49;&#xFF1A;</p>
<pre><code>CLASSPATH=${LLAP_DAEMON_CONF_DIR}:${LLAP_DAEMON_HOME}/lib/*:${LLAP_DAEMON_HOME}/lib/tez/*:${LLAP_DAEMON_HOME}/lib/udfs/*:.
</code></pre><p>  &#x5728;&#x4E0A;&#x5C42;&#x7684;lib&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x53D1;&#x73B0;&#x76F8;&#x5173;&#x7684;hadoop jar&#x6587;&#x4EF6;&#xFF0C;&#x56E0;&#x6B64;&#x5BFC;&#x81F4;llap daemon&#x65E0;&#x6CD5;&#x627E;&#x5230;&#x76F8;&#x5E94;&#x7684;&#x7C7B;&#xFF0C;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x4E5F;&#x5C31;&#x662F;&#x5728;&#x8FD9;&#x4E2A;CLASSPATH&#x7684;&#x672B;&#x5C3E;&#xFF0C;&#x52A0;&#x4E0A;<code>hadoop classpath</code>:</p>
<pre><code>CLASSPATH=${LLAP_DAEMON_CONF_DIR}:${LLAP_DAEMON_HOME}/lib/*:${LLAP_DAEMON_HOME}/lib/tez/*:${LLAP_DAEMON_HOME}/lib/udfs/*:.:`hadoop classpath`
</code></pre><p>&#x8FD9;&#x4E2A;&#x6700;&#x597D;&#x52A0;&#x5728;&#x540E;&#x9762;&#xFF0C;&#x56E0;&#x4E3A;&#x4E00;&#x4E9B;hive-site.xml&#x7684;&#x914D;&#x7F6E;&#x662F;&#x5728;&#x5B89;&#x88C5;&#x5305;&#x7684;conf&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x5982;&#x679C;&#x52A0;&#x5728;&#x524D;&#x9762;&#xFF0C;&#x5982;&#x679C;hadoop&#x73AF;&#x5883;&#x7684;&#x914D;&#x7F6E;&#x5305;&#x542B;&#x6709;hive-site.xml&#x6587;&#x4EF6;&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x52A0;&#x8F7D;&#x8BE5;&#x6587;&#x4EF6;&#x800C;&#x6452;&#x5F03;&#x4E86;&#x5BA2;&#x6237;&#x7AEF;llap hive-site.xml&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x4F1A;&#x5BFC;&#x81F4;&#x51FA;&#x73B0;<code>1.1</code>&#x63CF;&#x8FF0;&#x7684;&#x95EE;&#x9898;&#x3002;<br><br>&#x4FEE;&#x6539;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x91CD;&#x65B0;&#x6253;&#x5305;&#xFF0C;&#x518D;&#x6B21;&#x6267;&#x884C;run.sh&#x811A;&#x672C;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x6309;&#x7167;&#x8FD9;&#x6837;&#x7684;&#x601D;&#x8DEF;&#xFF0C;&#x89E3;&#x51B3;&#x5176;&#x4ED6;&#x95EE;&#x9898;&#x4E5F;&#x5C31;&#x5BB9;&#x6613;&#x5F88;&#x591A;&#x4E86;&#xFF0C;&#x53D1;&#x73B0;&#x67D0;&#x4E2A;udf&#x5F15;&#x5165;&#x4E86;&#x5176;&#x4ED6;&#x7684;jar&#x5305;&#x5BFC;&#x81F4;&#x7C7B;&#x51B2;&#x7A81;&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x8FD9;&#x4E2A;jar&#x4ECE;lib/udf&#x76EE;&#x5F55;&#x4E0B;&#x79FB;&#x9664;&#x51FA;&#x53BB;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x4E00;&#x4E9B;&#x914D;&#x7F6E;&#x7B49;&#x7B49;&#x3002;</p>
<pre><code>2, &#x67E5;&#x8BE2;&#x6548;&#x679C;&#x6CA1;&#x660E;&#x663E;&#x5DEE;&#x5F02;
</code></pre><p>&#x5C06;&#x8868;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#x6539;&#x6210;&#x4EE5;&#x5217;&#x5F0F;&#x6765;&#x5B58;&#x50A8;&#x3002; Llap&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;off-heap&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x7F13;&#x5B58;&#x6570;&#x636E;&#xFF0C;&#x5728;&#x4F7F;&#x7528;&#x5982;&#x4E0B;&#x547D;&#x4EE4;&#x751F;&#x6210;&#x811A;&#x672C;&#x65F6;&#xFF0C;<code>hive --service llap --name llap_service --size 4g --loglevel INFO  --cache 4g</code>&#xFF0C; &#x63D0;&#x793A;</p>
<pre><code>java.lang.IllegalArgumentException: Cache size (4.00GB) has to be smaller than the container sizing (4.00GB)
    at com.google.common.base.Preconditions.checkArgument(Preconditions.java:92)
    at org.apache.hadoop.hive.llap.cli.LlapServiceDriver.run(LlapServiceDriver.java:207)
    at org.apache.hadoop.hive.llap.cli.LlapServiceDriver.main(LlapServiceDriver.java:104)
</code></pre><p>&#x4E5F;&#x5C31;&#x662F;&#x5806;&#x5916;&#x7F13;&#x5B58;&#x7684;&#x5927;&#x5C0F;&#x8981;&#x5C0F;&#x4E8E;llap container&#x8BBE;&#x7F6E;&#x7684;&#x5185;&#x5B58;, &#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x6709;&#x8FD9;&#x4E2A;&#x7EA6;&#x675F;? &#x4ECE;&#x4E0E;&#x793E;&#x533A;&#x7684;&#x4EA4;&#x6D41;&#x6765;&#x770B;&#xFF0C;size&#x8868;&#x793A;&#x7684;&#x542B;&#x4E49;&#x662F;executor&#x5DE5;&#x4F5C;&#x5185;&#x5B58;&#x548C;&#x5806;&#x5916;&#x5185;&#x5B58;&#x4E4B;&#x548C;&#x3002;&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;&#xFF0C;&#x5374;&#x53D1;&#x73B0;size&#x51B3;&#x5B9A;&#x4E00;&#x4E2A;yarn container JVM&#x7684;&#x5B9E;&#x9645;&#x5927;&#x5C0F;&#xFF0C;&#x5E76;&#x672A;&#x6709;&#x6240;&#x6709;&#x5185;&#x5B58;&#x4E4B;&#x548C;&#x7684;&#x542B;&#x4E49;&#x3002;&#x4ECE;&#x4EE3;&#x7801;&#x6CE8;&#x91CA;&#x6765;&#x770B;&#xFF0C;&#x52A0;&#x4E0A;&#x8FD9;&#x4E00;&#x7EA6;&#x675F;&#x662F;&#x4E3A;&#x4E86;&#x66F4;&#x5B89;&#x5168;&#x7684;&#x5806;&#x5916;&#x5185;&#x5B58;&#x5206;&#x914D;&#xFF1F; &#x76EE;&#x524D;&#x91C7;&#x7528;&#x7684;&#x662F;&#x7528;size&#x8868;&#x793A;container&#x7684;&#x5B9E;&#x9645;JVM&#x5185;&#x5B58;&#xFF0C;&#x7528;cache&#x8868;&#x793A;&#x5806;&#x5916;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x3002;</p>
<p>&#x53E6;&#x5916;&#x4E5F;&#x53EF;&#x4EE5;&#x5C06;&#x7F13;&#x5B58;&#x8BBE;&#x7F6E;&#x6210;on heap&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x901A;&#x8FC7;&#x8BBE;&#x7F6E;&#xFF1A;</p>
<pre><code>&lt;property&gt;
     &lt;name&gt;hive.llap.io.allocator.direct&lt;/name&gt;
     &lt;value&gt;false&lt;/value&gt;
 &lt;/property&gt;
</code></pre><p>&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;llap&#x4E3A;&#x6BCF;&#x4E2A;executor&#x914D;&#x4E86;&#x4E00;&#x5B9A;&#x7684;&#x5185;&#x5B58;&#x9650;&#x989D;&#xFF1A;</p>
<pre><code>this.memoryPerExecutor = (long)(totalMemoryAvailableBytes * 0.8 / (float) numExecutors);
</code></pre><p>&#x8FD9;&#x8981;&#x6C42;tez task&#x7684;&#x4E34;&#x65F6;&#x5DE5;&#x4F5C;&#x5185;&#x5B58;&#x9700;&#x8981;&#x5C0F;&#x4E8E;&#x8FD9;&#x4E2A;&#x503C;&#xFF0C;&#x5982;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#xFF1A;</p>
<pre><code> &lt;property&gt;
  &lt;name&gt;tez.runtime.io.sort.mb&lt;/name&gt;
  &lt;defaultValue&gt;100&lt;/defaultValue&gt;
  &lt;type&gt;integer&lt;/type&gt;
&lt;/property&gt;    
</code></pre></div></article><div class="tags"><a href="../tags/大数据/">大数据</a><a href="../tags/Hadoop/">Hadoop</a><a href="../tags/Hive/">Hive</a><a href="../tags/Llap/">Llap</a></div><div class="paginator"><a href="../storm-core/" class="next"><span>Next</span><i class="iconfont icon-right"></i></a></div><section id="comments"><div id="disqus_thread"></div></section><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'https://dengzhhu653.github.io/hive-llap/';
    this.page.identifier = 'hive-llap/';
    this.page.title = 'Hive Llap尝试（0）';
};
(function() {
var d = document, s = d.createElement('script');

s.src = '//dengzhhu653.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();</script></section><footer><div class="copyright"><p class="power">Powered by <a href="https://hexo.io/">Hexo</a> and Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p><p class="since">&copy;2017<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">Zhihua Deng</span></p></div><label id="back2top"><i class="iconfont icon-up"></i></label></footer></div><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script></body></html>