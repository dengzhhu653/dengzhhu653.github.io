<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Zhihua Deng"><meta name="description" content="&amp;#x66F4;&amp;#x65B0;jar&amp;#x4E4B;&amp;#x540E;&amp;#x2026;&amp;#x95EE;&amp;#x9898;&amp;#x4ECE;&amp;#x4E00;&amp;#x4E2A;&amp;#x5F02;&amp;#x5E38;&amp;#x8BF4;&amp;#x8D77;&amp;#xFF1A;org.apache.had"><meta name="keywords" content="Jar,NoClassDefFoundError"><title>Jar Update · null</title><link rel="icon" href="../favicon.ico"><link rel="canonical" href="https://dengzhhu653.github.io/update_jar/"><link rel="alternate" href="../atom.xml" title="null"><link rel="stylesheet" href="../fonts/iconfont/iconfont.css"><link rel="stylesheet" href="../css/style.css"><script type="text/javascript">var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?Your baidu Analytics ID";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'Your Google Analytics ID', 'auto');
ga('send', 'pageview');</script></head><body><div id="main"><header><a href="../." class="logo"></a><ul class="nav"><li class="nav-link"><a href="/archives/" target="_self">Archives</a></li><li class="nav-link"><a href="/about/" target="_self">À propos</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">Jar Update</h1><span class="post-time">Nov 13, 2017</span><div id="sidebar" class="post-sidebar"><h3 class="heading">Sommaire</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#更新jar之后…"><span class="toc-text">更新jar之后…</span></a></li></ol></div><div class="post-content"><h2 id="&#x66F4;&#x65B0;jar&#x4E4B;&#x540E;&#x2026;"><a href="#&#x66F4;&#x65B0;jar&#x4E4B;&#x540E;&#x2026;" class="headerlink" title="&#x66F4;&#x65B0;jar&#x4E4B;&#x540E;&#x2026;"></a>&#x66F4;&#x65B0;jar&#x4E4B;&#x540E;&#x2026;</h2><p>&#x95EE;&#x9898;&#x4ECE;&#x4E00;&#x4E2A;&#x5F02;&#x5E38;&#x8BF4;&#x8D77;&#xFF1A;</p>
<pre>

org.apache.hadoop.hbase.client.RetriesExhaustedWithDetailsException: Failed 66 actions: org.apache.hadoop.hbase.DoNotRetryIOException: java.lang.NoClassDefFoundError: org/apache/hadoop/hbase/regionserver/ServerNonceManager$NonceKey

&#x200B;    at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2159)

&#x200B;    at org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:101)

&#x200B;    at org.apache.hadoop.hbase.ipc.RpcExecutor.consumerLoop(RpcExecutor.java:130)

&#x200B;    at org.apache.hadoop.hbase.ipc.RpcExecutor$1.run(RpcExecutor.java:107)

&#x200B;    at java.lang.Thread.run(Thread.java:745)

Caused by: java.lang.NoClassDefFoundError: org/apache/hadoop/hbase/regionserver/ServerNonceManager$NonceKey

&#x200B;    at org.apache.hadoop.hbase.regionserver.ServerNonceManager.startOperation(ServerNonceManager.java:175)

&#x200B;    at org.apache.hadoop.hbase.regionserver.RSRpcServices.startNonceOperation(RSRpcServices.java:330)

&#x200B;    at org.apache.hadoop.hbase.regionserver.RSRpcServices.increment(RSRpcServices.java:535)

&#x200B;    at org.apache.hadoop.hbase.regionserver.RSRpcServices.doNonAtomicRegionMutation(RSRpcServices.java:608)

&#x200B;    at org.apache.hadoop.hbase.regionserver.RSRpcServices.multi(RSRpcServices.java:2031)

&#x200B;    at org.apache.hadoop.hbase.protobuf.generated.ClientProtos$ClientService$2.callBlockingMethod(ClientProtos.java:32213)

&#x200B;    at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2120)

&#x200B;    ... 4 more

: 66 times,

&#x200B;    at org.apache.hadoop.hbase.client.AsyncProcess$BatchErrors.makeException(AsyncProcess.java:192) ~[hbase-client-0.98.4-hadoop2.jar:0.98.4-hadoop2]

&#x200B;    at org.apache.hadoop.hbase.client.AsyncProcess$BatchErrors.access$500(AsyncProcess.java:176) ~[hbase-client-0.98.4-hadoop2.jar:0.98.4-hadoop2]

&#x200B;    at org.apache.hadoop.hbase.client.AsyncProcess.getErrors(AsyncProcess.java:913) ~[hbase-client-0.98.4-hadoop2.jar:0.98.4-hadoop2]

&#x200B;    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.processBatchCallback(HConnectionManager.java:2359) ~[hbase-client-0.98.4-hadoop2.jar:0.98.4-hadoop2]

&#x200B;    at org.apache.hadoop.hbase.client.HTable.batchCallback(HTable.java:835) ~[hbase-client-0.98.4-hadoop2.jar:0.98.4-hadoop2]

&#x200B;    at org.apache.hadoop.hbase.client.HTable.batch(HTable.java:814) ~[hbase-client-0.98.4-hadoop2.jar:0.98.4-hadoop2]

...

</pre>

<p>&#x200B;       &#x5F53;&#x770B;&#x5230;&#x8FD9;&#x4E2A;&#x5F02;&#x5E38;&#x65F6;&#xFF0C;&#x60F3;&#x5230;&#x7684;&#x662F;&#x53EF;&#x80FD;&#x5BA2;&#x6237;&#x7AEF;classpath&#x4E2D;&#x7F3A;&#x5931;&#x67D0;&#x4E2A;&#x7C7B;&#x9020;&#x6210;&#x7684;&#xFF0C;&#x7ECF;&#x8FC7;&#x6392;&#x67E5;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x73AF;&#x5883;&#x4E4B;&#x540E;&#xFF0C;&#x53D1;&#x73B0;&#x5E76;&#x4E0D;&#x662F;&#x8FD9;&#x6837;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x7136;&#x800C;&#x8FD8;&#x662F;&#x88AB;&#x5BA2;&#x6237;&#x7AEF;&#x8DD1;&#x51FA;&#x8FD9;&#x6837;&#x7684;&#x5F02;&#x5E38;&#x8BE7;&#x5F02;&#x3002;&#x6309;&#x7167;&#x6808;&#x7684;&#x903B;&#x8F91;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x662F;&#x5728;RegionServer&#x4E0A;&#x53D1;&#x751F;&#x7684;&#x3002;</p>
<p>&#x200B;       &#x7ECF;&#x8FC7;&#x6392;&#x67E5;RegionServer&#x7684;classpath&#x4E4B;&#x540E;&#xFF0C;&#x786E;&#x5B9A;&#x5728;RegionServer&#x5E76;&#x4E0D;&#x5B58;&#x5728;&#x7C7B;&#x51B2;&#x7A81;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x6392;&#x67E5; RegionServer&#x6253;&#x5F00;&#x7684;hbase-server.jar&#x6587;&#x4EF6;&#xFF0C;&#x53D1;&#x73B0;&#x8FD9;&#x4E2A;jar&#x6587;&#x4EF6;&#x4E2D;&#x786E;&#x5B9E;&#x6709;ServerNonceManager$NonceKey&#x8FD9;&#x4E2A;&#x5185;&#x90E8;&#x7C7B;&#xFF0C;&#x7136;&#x800C;&#x4F7F;&#x7528;jmap -histo:live $pid | grep ServerNonceManager$NonceKey &#x547D;&#x4EE4;&#x4E4B;&#x540E;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x53D1;&#x73B0;&#x8FD9;&#x4E2A;&#x7C7B;&#x52A0;&#x8F7D;&#x8FDB;JVM&#x7684;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x67E5;&#x770B;RegionServer&#x4E0A;&#x7684;&#x65E5;&#x5FD7;&#xFF0C;&#x53D1;&#x73B0;&#x5E76;&#x6CA1;&#x6709;&#x8FD9;&#x6837;&#x7684;&#x5F02;&#x5E38;&#x8F93;&#x51FA;&#x3002;</p>
<p>&#x200B;       &#x5728;&#x81EA;&#x5DF1;&#x624B;&#x52A8;&#x7528;Java&#x7F16;&#x5199;&#x4E00;&#x4E2A;HBase&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x8FD9;&#x6837;&#x7684;&#x5F02;&#x5E38;&#x4E0D;&#x671F;&#x800C;&#x81F3;&#xFF0C;&#x51E0;&#x4E4E;&#x662F;&#x767E;&#x5206;&#x767E;&#x547D;&#x4E2D;&#x3002;&#x7A81;&#x7136;&#x60F3;&#x8D77;&#x6709;&#x4E2A;&#x5F02;&#x5E38;&#x662F;ClassNotFoundException&#x5F02;&#x5E38;&#xFF0C; &#x6BD4;&#x8F83;&#x8FD9;&#x4E24;&#x79CD;&#x5F02;&#x5E38;&#x7684;&#x533A;&#x522B;&#xFF1A;</p>
<pre>

 1&#xFF0C;ClassNotFoundException&#xFF0C; &#x662F;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528;Class.forName(&#x201C;$NAME&#x201D;) &#x6765;&#x52A8;&#x6001;&#x7684;&#x52A0;&#x8F7D;&#x67D0;&#x4E2A;&#x7C7B;&#xFF0C; JVM&#x5728;&#x5F53;&#x524D;&#x7684;Classpath&#x4E0B;&#x5E76;&#x6CA1;&#x6709;&#x53D1;&#x73B0;&#x8FD9;&#x4E2A;&#x7C7B;&#x3002;&#x5373;&#x4F7F;&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x7C7B;&#xFF0C; &#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7F16;&#x8BD1;&#x3002;

  2&#xFF0C; NoClassDefFoundError&#xFF0C; &#x662F;&#x5DF2;&#x7ECF;&#x7F16;&#x8BD1;&#x597D;&#x7684;&#x6587;&#x4EF6;&#xFF0C; JVM&#x5728;&#x521B;&#x5EFA;&#x8BE5;&#x7C7B;&#x7684;Class&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x53D1;&#x73B0;&#x8BE5;&#x7C7B;&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x9700;&#x8981;&#x521B;&#x5EFA;Class&#xFF1F; 

&#x200B;      1&#xFF09; &#x8C03;&#x7528;&#x7C7B;&#x7684;&#x9759;&#x6001;&#x5C5E;&#x6027;&#x6216;&#x65B9;&#x6CD5;&#x65F6;&#x3002;

&#x200B;      2&#xFF09; new &#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x5BF9;&#x8C61;&#x65F6;

 &#x6B64;&#x65F6;&#x7531;&#x4E8E;&#x5728;jvm&#x4E2D;&#x672A;&#x53D1;&#x73B0;&#x7C7B;&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x80AF;&#x5B9A;&#x4E8B;&#x5148;&#x5728;Class&#x8DEF;&#x5F84;&#x4E0B;&#x627E;&#x4E86;&#x4E00;&#x904D;&#xFF0C;&#x4F46;&#x662F;&#x6CA1;&#x6709;&#x627E;&#x5230;&#x3002;

</pre>

<p>&#x200B;       &#x60F3;&#x8D77;&#x524D;&#x4E9B;&#x5929;&#x66F4;&#x65B0;hbase jar&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x53EA;&#x662F;&#x7B80;&#x5355;&#x5730;&#x5C06;&#x8BE5;jar&#x6587;&#x4EF6;&#x8986;&#x76D6;&#x6389;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x91CD;&#x542F;&#x76F8;&#x5173;&#x7684;&#x670D;&#x52A1;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x5728;jvm&#x4E2D;&#xFF0C;&#x4F7F;&#x7528;&#x7684;jar&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x662F;&#x4E00;&#x4E2A;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x53E5;&#x67C4;(&#x901A;&#x8FC7;lsof&#x53EF;&#x4EE5;&#x89C2;&#x5BDF;&#x5230;&#x8FD9;&#x6837;&#x7684;&#x73B0;&#x8C61;)&#x3002;&#x8FD9;&#x5C31;&#x5BFC;&#x81F4;&#x4E86;&#x7C7B;&#x4F3C;&#x4E8E;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5176;&#x4F9D;&#x8D56;&#x7684;jar&#x6587;&#x4EF6;&#x5220;&#x9664;&#xFF0C;&#x5F53;&#x4F9D;&#x7167;&#x7C7B;&#x8DEF;&#x5F84;&#x4ECE;&#x78C1;&#x76D8;&#x4E2D;&#x52A0;&#x8F7D;&#x8BE5;&#x7C7B;&#x65F6;&#xFF0C;&#x7C7B;&#x5DF2;&#x7ECF;&#x88AB;&#x5220;&#x9664;&#xFF0C;&#x8FD9;&#x6837;&#x4FBF;&#x5BFC;&#x81F4;&#x4E86;&#x8BE5;&#x95EE;&#x9898;&#x7684;&#x51FA;&#x73B0;&#x3002;&#x5C06;RegionServer&#x670D;&#x52A1;&#x91CD;&#x542F;&#x4E4B;&#x540E;&#xFF0C;&#x8BE5;&#x95EE;&#x9898;&#x6D88;&#x5931;&#x3002;</p>
<p>&#x4E00;&#x4E9B;&#x7ED3;&#x8BBA;&#xFF1A;</p>
<p>1&#xFF0C; &#x5F53;&#x670D;&#x52A1;&#x53D1;&#x751F;jar&#x6587;&#x4EF6;&#x66F4;&#x65B0;&#x65F6;&#xFF0C;&#x4E0D;&#x7BA1;&#x600E;&#x4E48;&#x6837;&#xFF0C;&#x90FD;&#x8981;&#x91CD;&#x542F;&#x6574;&#x4E2A;&#x670D;&#x52A1;&#xFF0C;&#x5426;&#x5219;&#xFF0C;&#x4F1A;&#x6709;&#x83AB;&#x540D;&#x5176;&#x5999;&#x7684;&#x95EE;&#x9898;&#x7B49;&#x7740;&#x53BB;&#x89E3;&#x51B3;&#x3002;</p>
<p>2&#xFF0C; &#x5728;&#x53D1;&#x73B0;&#x6709;&#x7C7B;&#x51B2;&#x7A81;&#x65F6;&#xFF0C; &#x53EF;&#x4EE5;&#x5728;JVM&#x542F;&#x52A8;&#x53C2;&#x6570;&#x4E0A;&#xFF0C; &#x52A0;&#x4E0A; -verbose:class &#x53C2;&#x6570;&#x6765;&#x89C2;&#x5BDF;&#x7C7B;&#x52A0;&#x8F7D;&#x7684;&#x8DEF;&#x5F84;&#x3002;</p>
<p>&#x200B;      </p>
</div></article><div class="tags"><a href="../tags/Jar/">Jar</a><a href="../tags/NoClassDefFoundError/">NoClassDefFoundError</a></div><div class="paginator"><a href="../hdfs-nfs/" class="prev"><i class="iconfont icon-left"></i><span> Précédent</span></a><a href="../GC/" class="next"><span>Suivant</span><i class="iconfont icon-right"></i></a></div><section id="comments"><div id="disqus_thread"></div></section><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'https://dengzhhu653.github.io/update_jar/';
    this.page.identifier = 'update_jar/';
    this.page.title = 'Jar Update';
};
(function() {
var d = document, s = d.createElement('script');

s.src = '//dengzhhu653.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();</script></section><footer><div class="copyright"><p class="power">Powered by <a href="https://hexo.io/">Hexo</a> and Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p><p class="since">&copy;2018<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">Zhihua Deng</span></p></div><label id="back2top"><i class="iconfont icon-up"></i></label></footer></div><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script></body></html>